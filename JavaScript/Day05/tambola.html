<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tambola / Full House Game</title>
  <style>
    body {
      font-family: Arial;
      background: #f4f6f8;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    button {
      padding: 10px 20px;
      margin: 10px 0;
      font-size: 16px;
      cursor: pointer;
    }

    table {
      border-collapse: collapse;
      margin: 20px auto;
      background: #fff;
    }

    td {
      width: 60px;
      height: 50px;
      border: 2px solid #333;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
    }

    .empty {
      background: #eaeaea;
    }

    #numberBox {
      text-align: center;
      font-size: 28px;
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>ðŸŽ² Tambola / Full House Game</h1>

<div style="text-align:center">
  <button onclick="generateTicket()">Generate Ticket</button>
  <button onclick="drawNumber()">Draw Number</button>
</div>

<div id="numberBox">Number: --</div>
<div style="background-color: yellow;" class="p-3 m-5">
    <table id="ticket" class="m-3 p-3"></table>
</div>
<script>
// -------------------------------
// GLOBAL STORAGE
// -------------------------------
let drawnNumbers = new Set();

// Column ranges
const ranges = [
  [1, 10],
  [11, 20],
  [21, 30],
  [31, 40],
  [41, 50],
  [51, 60],
  [61, 70],
  [71, 80],
  [81, 90]
];

// -------------------------------
// GENERATE RANDOM NUMBER
// -------------------------------
function random(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

// -------------------------------
// DRAW RANDOM NUMBER (1â€“90)
// -------------------------------
function drawNumber() {
  if (drawnNumbers.size === 90) {
    alert("All numbers are drawn!");
    return;
  }

  let num;
  do {
    num = random(1, 90);
  } while (drawnNumbers.has(num));

  drawnNumbers.add(num);
  document.getElementById("numberBox").innerText = "Number: " + num;
}

// -------------------------------
// GENERATE TAMBOLA TICKET
// 3 rows Ã— 9 columns
// 5 numbers per row
// No empty row or column
// Column range maintained
// -------------------------------
function generateTicket() {
  const ticket = Array.from({ length: 3 }, () => Array(9).fill(""));

  // Step 1: decide which 5 columns will have numbers in each row
  let rowPositions = [];

  for (let r = 0; r < 3; r++) {
    let cols = [];
    while (cols.length < 5) {
      let c = random(0, 8);
      if (!cols.includes(c)) cols.push(c);
    }
    rowPositions.push(cols);
  }

  // Ensure no column is empty
  for (let c = 0; c < 9; c++) {
    let count = 0;
    for (let r = 0; r < 3; r++) {
      if (rowPositions[r].includes(c)) count++;
    }

    if (count === 0) {
      let r = random(0, 2);
      rowPositions[r][0] = c;
    }
  }

  // Step 2: fill numbers column-wise
  for (let c = 0; c < 9; c++) {
    let cells = [];

    for (let r = 0; r < 3; r++) {
      if (rowPositions[r].includes(c)) cells.push(r);
    }

    let used = new Set();

    cells.forEach(r => {
      let num;
      do {
        num = random(ranges[c][0], ranges[c][1]);
      } while (used.has(num));

      used.add(num);
      ticket[r][c] = num;
    });

    // Sort column numbers (top to bottom)
    let sorted = cells.map(r => ticket[r][c]).sort((a, b) => a - b);

    sorted.forEach((val, i) => {
      ticket[cells[i]][c] = val;
    });
  }

  renderTicket(ticket);
}

// -------------------------------
// DISPLAY TICKET
// -------------------------------
function renderTicket(ticket) {
  const table = document.getElementById("ticket");
  table.innerHTML = "";

  for (let r = 0; r < 3; r++) {
    const tr = document.createElement("tr");

    for (let c = 0; c < 9; c++) {
      const td = document.createElement("td");

      if (ticket[r][c] === "") {
        td.className = "empty";
        td.innerHTML = "";
      } else {
        td.innerHTML = ticket[r][c];
      }

      tr.appendChild(td);
    }

    table.appendChild(tr);
  }
}
</script>

</body>
</html>
